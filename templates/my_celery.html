<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>django celery</title>
</head>
<body>
    <div style="text-align: center; font-size: 30px; margin-top: 30px">
        <h1>ğŸ django3 celery ä¸å†ä½¿ç”¨django-celery ğŸ‚</h1>
        <a href="/">æ¬¢è¿æ¥åˆ° django celery / RadditMQ/REDIS æœ€ä½³å®è·µ ğŸ˜€</a>
    </div>

    <div>
        {{ msg }}
    </div>

    <div style="margin-top: 40px; margin-left: 400px">
    <h3 style="color: indianred">
        å®šæ—¶ä»»åŠ¡åˆ—è¡¨: {{ task_list | length }}
        <a style="color: #69e510; margin-left: 20px" href="add_time_task">æ–°å¢å®šæ—¶</a>
    </h3>
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>åç§°</th>
                <th>task</th>
                <th>args</th>
                <th>å¯ç”¨</th>
                <th>æœ€è¿‘è¿è¡Œæ—¶é—´</th>
                <th>è¿è¡Œæ¬¡æ•°</th>
                <th>æ“ä½œ</th>
            </tr>
            </thead>
            <tbody>
            <!--tdä¸­styleæ˜¾ç¤ºå†…å®¹è¶…é•¿å†…å®¹éšè—ï¼Œå’Œé™åˆ¶å†…å®¹æ˜¾ç¤ºæ¡†å¤§å°-->
            {% for task in task_list %}
            <tr>
                <td>{{ task.id }}</td>
                <td style="color: #69e510">{{ task.name }}</td>
                <td>{{ task.task }}</td>
                <td>{{ task.args }}</td>
                <td>{{ task.enabled }}</td>
                <td>{{ task.last_run_at }}</td>
                <td>{{ task.total_run_count }}</td>

                <td>
                    <a style="background-color: #E8E8E8;color: #69e510" href="update_time_task/{{ task.id }}/">åˆ‡æ¢å¯ç”¨</a>
                    <a style="background-color: #E8E8E8;color: #69e510" href="run_async_task/{{ task.id }}/">å¼‚æ­¥è¿è¡Œ</a>
                    <a style="background-color: #E8E8E8;color: #d59412" href="delete/{{ task.id }}/">åˆ é™¤</a>
{#                    <a style="background-color: #E8E8E8;color: #d59412" href="delete/{{ task.id }}/"#}
{#                       onclick="{if(confirm('ç¡®å®šåˆ é™¤ {{ task.name }} å—?')){this.document.formname.submit();return true;}return false;}">åˆ é™¤</a>#}
                </td>
            </tr>
            {% endfor %}

            </tbody>

        </table>
    </div>

    <div style="margin-top: 50px; margin-left: 400px">
    <h3 style="color: indianred">
        celery ä»»åŠ¡è§¦å‘è®°å½•: {{ task_result_list | length }}
        <a style="color: #d59412; margin-left: 20px" href="delete_all"
            onclick="{if(confirm('ç¡®å®šæ¸…ç©ºå—?')){this.document.formname.submit();return true;}return false;}">æ¸…ç©º</a>
    </h3>

        <table>
            <thead>
            <tr>
                <th>task_id</th>
                <th>task_name</th>
                <th>result</th>
                <th>status</th>
                <th>date_done</th>
                <th>worker</th>
                <th>traceback</th>
            </tr>
            </thead>
            <tbody>
            <!--tdä¸­styleæ˜¾ç¤ºå†…å®¹è¶…é•¿å†…å®¹éšè—ï¼Œå’Œé™åˆ¶å†…å®¹æ˜¾ç¤ºæ¡†å¤§å°-->
            {% for task_result in task_result_list %}
            <tr>
                <td>{{ task_result.task_id }}</td>
                <td>{{ task_result.task_name }}</td>
                <td style="color: #69e510; max-width: 300px;overflow: hidden; text-overflow:ellipsis;white-space: nowrap">{{ task_result.result }}</td>
                <td>{{ task_result.status }}</td>
                <td>{{ task_result.date_done }}</td>
                <td>{{ task_result.worker }}</td>
                <td style="max-width: 300px;overflow: hidden; text-overflow:ellipsis;white-space: nowrap">{{ task_result.traceback }}</td>
            </tr>
            {% endfor %}

            </tbody>

        </table>
    </div>

</body>
</html>
